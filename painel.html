<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>AI Prof - Painel</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: white;
    text-align: center;
}
#painel {
    max-width: 600px;
    margin: auto;
    background: #1e293b;
    padding: 15px;
    border-radius: 10px;
}
#mensagens {
    background: #020617;
    height: 250px;
    overflow-y: auto;
    padding: 10px;
    border-radius: 8px;
    text-align: left;
}
.linha {
    display: flex;
    margin-top: 10px;
    gap: 5px;
}
button {
    padding: 8px;
}
input[type="text"] {
    flex: 1;
    padding: 8px;
}
</style>

</head>
<body>

<div id="painel">
    <h1>AI Prof</h1>

    <p>Usu√°rio: <b><span id="user"></span></b></p>
    <p>Moedas: ü™ô <span id="moedas">0</span></p>

    <h3>Chat do AI Prof</h3>

    <div id="mensagens"></div>

    <div class="linha">
        <button onclick="enviar()">Enviar</button>
        <input id="texto" type="text" placeholder="Digite qualquer pergunta">
    </div>
</div>

<script>
// ================= LOGIN =================
const usuario = localStorage.getItem("usuarioLogado");

if (!usuario) {
    alert("Voc√™ precisa fazer login primeiro!");
    window.location.href = "index.html";
}

document.getElementById("user").innerText = usuario;

// ================= MOEDAS =================
let moedas = 0;
setInterval(() => {
    moedas++;
    document.getElementById("moedas").innerText = moedas;
}, 1000);

// ================= CHAT =================
async function enviar() {
    const textoEl = document.getElementById("texto");
    const mensagem = textoEl.value.trim();
    if (!mensagem) return;

    const chat = document.getElementById("mensagens");

    chat.innerHTML += `<p><b>Voc√™:</b> ${mensagem}</p>`;
    textoEl.value = "";

    const loadingId = Date.now();
    chat.innerHTML += `<p id="${loadingId}"><b>AI Prof:</b> Pensando...</p>`;
    chat.scrollTop = chat.scrollHeight;

    const resposta = await chamarIA(mensagem);

    document.getElementById(loadingId).innerHTML =
        `<b>AI Prof:</b> ${resposta}`;
}

// ================= IA REAL =================
async function chamarIA(pergunta) {
    const API_KEY = "COLE_SUA_API_KEY_AQUI"; // ‚ö†Ô∏è COLE SUA CHAVE

    try {
        const response = await fetch(
            "https://api.openai.com/v1/chat/completions",
            {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer " + API_KEY
                },
                body: JSON.stringify({
                    model: "gpt-4o-mini",
                    messages: [
                        {
                            role: "system",
                            content: "Voc√™ √© o AI Prof, um professor inteligente que responde qualquer pergunta em portugu√™s de forma clara."
                        },
                        {
                            role: "user",
                            content: pergunta
                        }
                    ]
                })
            }
        );

        if (!response.ok) {
            return "Erro da IA (status " + response.status + ")";
        }

        const data = await response.json();

        if (!data.choices || !data.choices[0]) {
            return "Resposta inv√°lida da IA.";
        }

        return data.choices[0].message.content;

    } catch (erro) {
        return "Erro de conex√£o com a IA.";
    }
}
</script>

</body>
</html>
