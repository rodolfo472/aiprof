<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Brainrot City INSANO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
body{margin:0;overflow:hidden;background:black;touch-action:none;font-family:Arial}

#ui{
position:fixed;
top:10px;
left:10px;
color:white;
background:rgba(0,0,0,0.5);
padding:10px;
border-radius:12px;
font-size:16px;
z-index:10;
}

#joystickBase{
position:fixed;
bottom:80px;
left:40px;
width:120px;
height:120px;
background:rgba(255,255,255,0.1);
border-radius:50%;
z-index:10;
}

#joystick{
position:absolute;
width:60px;
height:60px;
left:30px;
top:30px;
background:rgba(255,255,255,0.4);
border-radius:50%;
}

#stealBtn{
position:fixed;
bottom:120px;
right:30px;
width:80px;
height:80px;
border-radius:50%;
background:rgba(255,0,0,0.4);
color:white;
font-size:30px;
text-align:center;
line-height:80px;
z-index:10;
}
</style>
</head>
<body>

<div id="ui">
ðŸ’° <span id="money">0</span><br>
ðŸ§  <span id="steals">0</span>
</div>

<div id="joystickBase">
<div id="joystick"></div>
</div>

<div id="stealBtn">ðŸ§ </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
// DETECTAR DISPOSITIVO
const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);
if(!isMobile){
  document.getElementById("joystickBase").style.display="none";
  document.getElementById("stealBtn").style.display="none";
}

// CENA
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

const camera = new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,0.7));
const light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,10,5);
scene.add(light);

// CHÃƒO
const floor = new THREE.Mesh(
new THREE.PlaneGeometry(300,300),
new THREE.MeshStandardMaterial({color:0x3cb371})
);
floor.rotation.x=-Math.PI/2;
scene.add(floor);

// PRÃ‰DIOS
for(let i=0;i<20;i++){
let h=Math.random()*10+5;
const building = new THREE.Mesh(
new THREE.BoxGeometry(4,h,4),
new THREE.MeshStandardMaterial({color:0x888888})
);
building.position.set(Math.random()*100-50,h/2,Math.random()*100-50);
scene.add(building);
}

// PLAYER
const player = new THREE.Mesh(
new THREE.BoxGeometry(1,2,1),
new THREE.MeshStandardMaterial({color:0x0000ff})
);
player.position.y=1;
scene.add(player);

// BRAINROTS
let brainrots=[];
for(let i=0;i<10;i++){
const b=new THREE.Mesh(
new THREE.SphereGeometry(1,32,32),
new THREE.MeshStandardMaterial({color:Math.random()*0xffffff})
);
b.position.set(Math.random()*80-40,1,Math.random()*80-40);
scene.add(b);
brainrots.push(b);
}

// POLÃCIA
const police=new THREE.Mesh(
new THREE.BoxGeometry(1,2,1),
new THREE.MeshStandardMaterial({color:0xff0000})
);
police.position.set(15,1,15);
scene.add(police);

// PROGRESSO
let money=parseInt(localStorage.getItem("money"))||0;
let steals=parseInt(localStorage.getItem("steals"))||0;
updateUI();

function updateUI(){
document.getElementById("money").innerText=money;
document.getElementById("steals").innerText=steals;
}

// ===== CONTROLES MOBILE =====
let joyX=0, joyY=0;
let camAngle=0;

if(isMobile){
const joystick=document.getElementById("joystick");
const base=document.getElementById("joystickBase");

base.addEventListener("touchmove",(e)=>{
let rect=base.getBoundingClientRect();
let x=e.touches[0].clientX-rect.left-60;
let y=e.touches[0].clientY-rect.top-60;
let dist=Math.sqrt(x*x+y*y);
if(dist>40){x=x/dist*40;y=y/dist*40;}
joystick.style.left=30+x+"px";
joystick.style.top=30+y+"px";
joyX=x/40;
joyY=y/40;
});

base.addEventListener("touchend",()=>{
joystick.style.left="30px";
joystick.style.top="30px";
joyX=0; joyY=0;
});

document.addEventListener("touchmove",(e)=>{
camAngle += (e.touches[0].movementX||0)*0.002;
});

document.getElementById("stealBtn").addEventListener("touchstart",stealBrainrot);
}

// ===== CONTROLES PC =====
let keys={};
document.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);
document.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);

let mouseDown=false;
let lastX=0;

document.addEventListener("mousedown",e=>{
mouseDown=true;
lastX=e.clientX;
});
document.addEventListener("mouseup",()=>mouseDown=false);
document.addEventListener("mousemove",e=>{
if(mouseDown){
camAngle+=(e.clientX-lastX)*0.005;
lastX=e.clientX;
}
});

document.addEventListener("keydown",e=>{
if(e.key.toLowerCase()==="e") stealBrainrot();
});

// ROUBAR
function stealBrainrot(){
brainrots.forEach(b=>{
if(player.position.distanceTo(b.position)<2){
money+=50;
steals++;
localStorage.setItem("money",money);
localStorage.setItem("steals",steals);
updateUI();
b.position.set(Math.random()*80-40,1,Math.random()*80-40);
}
});
}

// LOOP
function animate(){
requestAnimationFrame(animate);

let speed = keys["shift"]?0.5:0.25;

if(isMobile){
player.position.x+=joyX*0.3;
player.position.z+=joyY*0.3;
}else{
if(keys["w"]) player.position.z-=speed;
if(keys["s"]) player.position.z+=speed;
if(keys["a"]) player.position.x-=speed;
if(keys["d"]) player.position.x+=speed;
}

// cÃ¢mera 3Âª pessoa
camera.position.x=player.position.x+Math.sin(camAngle)*6;
camera.position.z=player.position.z+Math.cos(camAngle)*6;
camera.position.y=player.position.y+4;
camera.lookAt(player.position);

// polÃ­cia persegue
police.position.x+=(player.position.x-police.position.x)*0.02;
police.position.z+=(player.position.z-police.position.z)*0.02;

if(player.position.distanceTo(police.position)<1.5){
alert("ðŸš” VOCÃŠ FOI PRESO!");
money=0;steals=0;
localStorage.clear();
updateUI();
player.position.set(0,1,0);
}

brainrots.forEach(b=>b.rotation.y+=0.05);
renderer.render(scene,camera);
}
animate();

window.addEventListener("resize",()=>{
camera.aspect=innerWidth/innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
